# Система распознавания жестов русского жестового языка

Полная система для обучения и распознавания жестов русского жестового языка в реальном времени с использованием LSTM нейронных сетей и MediaPipe.

## Описание проекта

Система способна распознавать 13 классов жестов:
- 12 жестов русского жестового языка: веселиться, воскресенье, вторник, выходные, любить, осень, понедельник, пятница, редко, среда, суббота, четверг
- 1 класс "no_event" для отсутствия жеста

## Структура проекта

```
clean_model/
├── 13class_model_output/          # Обученная модель
│   ├── 13class_gesture_model.pth   # Веса модели
│   ├── config.json                 # Конфигурация модели
│   ├── scaler.pkl                  # Нормализатор данных
│   └── training_history.png        # График обучения
├── gesture_lstm_model_13class.py   # Архитектура LSTM модели
├── train_13class_model.py          # Скрипт обучения
├── realtime_13class_recognition.py # Приложение реального времени
├── requirements.txt                # Зависимости
└── README.md                       # Данный файл
```

## Требования

### Системные требования
- Python 3.8+
- CUDA-совместимая видеокарта (рекомендуется)
- Веб-камера для работы в реальном времени

### Установка зависимостей

```bash
pip install -r requirements.txt
```

## Подготовка данных

### 1. Структура видеоданных

Видеофайлы должны быть организованы следующим образом:

```
train/
├── веселиться/
│   ├── веселиться1.mp4
│   ├── веселиться2.mp4
│   └── ...
├── воскресенье/
│   ├── воскресенье1.mp4
│   └── ...
└── [другие классы жестов]/
```

### 2. Требования к видео

- **Формат**: MP4, AVI или другие поддерживаемые OpenCV форматы
- **Разрешение**: Рекомендуется 640x480 или выше
- **Частота кадров**: 30 FPS или выше
- **Длительность**: 2-10 секунд на жест
- **Качество**: Хорошее освещение, четкая видимость рук
- **Фон**: Желательно контрастный фон для лучшего выделения рук

### 3. Рекомендации по съемке

- Руки должны быть полностью видны в кадре
- Избегайте быстрых движений камеры
- Обеспечьте равномерное освещение
- Снимайте жесты с разных ракурсов для лучшего обобщения
- Включайте вариации скорости выполнения жеста

## Процесс обучения

### 1. Запуск обучения

```bash
python train_13class_model.py
```

### 2. Параметры обучения

Основные параметры можно настроить в файле `train_13class_model.py`:

```python
# Параметры модели
SEQUENCE_LENGTH = 30        # Длина последовательности кадров
NUM_CLASSES = 13            # Количество классов
HIDDEN_SIZE = 128           # Размер скрытого слоя LSTM
NUM_LAYERS = 2              # Количество слоев LSTM
DROPOUT = 0.3               # Dropout для регуляризации

# Параметры обучения
BATCH_SIZE = 32             # Размер батча
LEARNING_RATE = 0.001       # Скорость обучения
NUM_EPOCHS = 100            # Количество эпох
PATIENCE = 15               # Терпение для early stopping
```

### 3. Процесс обучения

1. **Извлечение ключевых точек**: Система использует MediaPipe для извлечения 63 ключевых точек для каждой руки (126 точек для двух рук)
2. **Создание последовательностей**: Видео разбивается на последовательности из 30 кадров
3. **Нормализация данных**: Применяется StandardScaler для нормализации координат
4. **Обучение LSTM**: Двухслойная LSTM сеть обучается на последовательностях
5. **Валидация**: 20% данных используется для валидации
6. **Early Stopping**: Обучение останавливается при отсутствии улучшения

### 4. Результаты обучения

После обучения создаются файлы:
- `13class_gesture_model.pth` - веса обученной модели
- `config.json` - конфигурация модели
- `scaler.pkl` - нормализатор данных
- `training_history.png` - график потерь и точности

## Запуск распознавания в реальном времени

### 1. Запуск приложения

```bash
python realtime_13class_recognition.py
```

### 2. Управление приложением

- **ESC** - выход из приложения
- **R** - сброс статистики
- **S** - показать/скрыть статистику

### 3. Интерфейс приложения

Приложение отображает:
- **Видео с камеры** с наложенными ключевыми точками рук
- **Распознанный жест** с уровнем уверенности
- **Статус стабильности** предсказания
- **Список всех классов** жестов
- **FPS** и другую системную информацию
- **Цветовая дифференциация** рук (синий - левая, красный - правая)

## Технические особенности

### Архитектура модели

```python
class GestureLSTM(nn.Module):
    def __init__(self, input_size=126, hidden_size=128, num_layers=2, num_classes=13, dropout=0.3):
        # Двухслойная LSTM с dropout
        # Полносвязный слой для классификации
```

### MediaPipe настройки

```python
mp_hands = mp.solutions.hands.Hands(
    static_image_mode=False,
    max_num_hands=2,              # Поддержка двух рук
    min_detection_confidence=0.7, # Высокая точность детекции
    min_tracking_confidence=0.5,  # Оптимизированное отслеживание
    model_complexity=1            # Баланс скорости и точности
)
```

### Система фильтрации предсказаний

- **Буфер предсказаний**: Анализ последних 12 кадров
- **Весовой алгоритм**: Учет частоты, уверенности и стабильности
- **Адаптивные пороги**: Динамические пороги уверенности
- **Анализ стабильности**: Использование стандартного отклонения

## Оптимизация производительности

### GPU ускорение

```python
# Автоматическое определение устройства
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
print(f"Используется устройство: {device}")
```

### Настройки камеры

```python
cap.set(cv2.CAP_PROP_FRAME_WIDTH, 640)
cap.set(cv2.CAP_PROP_FRAME_HEIGHT, 480)
cap.set(cv2.CAP_PROP_FPS, 30)
```

## Устранение неполадок

### Проблемы с камерой
- Убедитесь, что камера не используется другими приложениями
- Проверьте права доступа к камере
- Попробуйте изменить индекс камеры в коде

### Проблемы с CUDA
- Установите совместимую версию PyTorch с CUDA
- Проверьте версию CUDA: `nvidia-smi`
- При отсутствии CUDA система автоматически переключится на CPU

### Низкая точность распознавания
- Улучшите освещение
- Убедитесь, что руки полностью видны
- Выполняйте жесты четко и медленно
- Проверьте калибровку камеры

### Низкая производительность
- Закройте другие ресурсоемкие приложения
- Уменьшите разрешение камеры
- Используйте GPU для ускорения

## Расширение системы

### Добавление новых жестов

1. Создайте папку с видео нового жеста в директории `train/`
2. Обновите `NUM_CLASSES` в скрипте обучения
3. Добавьте название класса в список `class_names`
4. Переобучите модель

### Улучшение точности

1. Увеличьте количество обучающих видео
2. Улучшите качество видеоданных
3. Настройте гиперпараметры модели
4. Используйте аугментацию данных
5. Экспериментируйте с архитектурой сети

## Лицензия

Проект разработан для исследовательских и образовательных целей.

## Контакты

Для вопросов и предложений по улучшению системы обращайтесь к разработчикам проекта.

---

**Версия**: 1.0  
**Дата**: 2024  
**Точность модели**: 62.86%  
**Поддерживаемые классы**: 13